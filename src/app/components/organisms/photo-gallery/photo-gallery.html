<section class="gallery-container">
  <header class="gallery-header">
    <div class="gallery-heading">
      <h1 class="gallery-title">Nuestros recuerdos</h1>
      <p class="gallery-subtitle">
        Elige un momento para revivirlo. Las fotos mÃ¡s recientes aparecen primero.
      </p>
    </div>

    <div class="gallery-filters" aria-label="Filtrar por aÃ±o">
      @for (year of filterYears; track year) {
        <button
          type="button"
          class="filter-chip"
          [class.is-active]="activeYear === year"
          (click)="filterByYear(year)"
        >
          {{ year === 'all' ? 'Todos' : year }}
        </button>
      }
    </div>
  </header>

  @if (isSkeletonVisible) {
    <div class="gallery-skeleton" aria-hidden="true">
      @for (placeholder of skeletonPlaceholders; track placeholder) {
        <div class="skeleton-card"></div>
      }
      <p class="skeleton-message">Cargando recuerdosâ€¦</p>
    </div>
  }

  @if (photos.length === 0) {
    <div class="gallery-empty">
      <p>No encontramos recuerdos para ese filtro. Prueba con otro aÃ±o ðŸ’–</p>
    </div>
  } @else {
    <div class="gallery-grid" [class.is-loading]="isSkeletonVisible">
      @for (photo of photos; track photo.id) {
        <div class="gallery-item" [class.is-loaded]="hasPhotoLoaded(photo.id)">
          <app-photo-card
            [photo]="photo"
            (openPreview)="openPreview($event)"
            (imageLoaded)="onPhotoLoaded($event)"
          ></app-photo-card>
        </div>
      }
    </div>
  }

  @if (selectedPhoto) {
    <app-photo-preview
      [photo]="selectedPhoto"
      [hasNext]="hasNextPhoto"
      [hasPrevious]="hasPreviousPhoto"
      [index]="selectedIndex"
      [total]="photos.length"
      (close)="closePreview()"
      (next)="showNextPhoto()"
      (previous)="showPreviousPhoto()"
    ></app-photo-preview>
  }
</section>
