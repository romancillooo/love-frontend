<nav class="navbar" *ngIf="isRouteAllowed" [class.hidden]="!isVisible">
  <div class="navbar-content">
    <div class="primary-row">
      <!-- üîπ Lado izquierdo -->
      <div class="left-slot">
        <button
          *ngIf="showBackButton"
          class="back-btn icon-btn"
          type="button"
          (click)="goBack()"
          aria-label="Volver"
        >
          <mat-icon>arrow_back</mat-icon>
        </button>

        <button
          class="menu-toggle icon-btn"
          type="button"
          (click)="toggleMenu()"
          aria-label="Abrir men√∫"
        >
          <mat-icon>{{ menuOpen() ? 'close' : 'menu' }}</mat-icon>
        </button>
      </div>

      <!-- üîπ Bot√≥n "+" con men√∫ desplegable -->
      <div *ngIf="isPhotosRoute" class="upload-menu-container">
        <button
          class="upload-btn icon-btn"
          type="button"
          (click)="toggleUploadMenu()"
          aria-label="Subir contenido"
          [class.is-active]="uploadMenuOpen()"
        >
          <mat-icon>add</mat-icon>
        </button>

        <!-- Men√∫ desplegable -->
        <div class="upload-dropdown" *ngIf="uploadMenuOpen()">
          <button type="button" class="dropdown-item" (click)="openImageUploader()">
            <mat-icon>photo_library</mat-icon>
            <span>Subir Recuerdos</span>
          </button>
          <button type="button" class="dropdown-item" (click)="openAlbumCreator()">
            <mat-icon>photo_album</mat-icon>
            <span>Crear Nuevo √Ålbum</span>
          </button>
        </div>
      </div>
    </div>

    <!-- üîπ Enlaces -->
    <div class="nav-links" [class.is-open]="menuOpen()">
      <a
        *ngFor="let link of navigationLinks"
        routerLinkActive="is-active"
        [routerLinkActiveOptions]="{ exact: true }"
        [routerLink]="link.route"
        class="nav-link"
        [class.is-current]="activeNavRoute === link.route"
        (click)="closeMenu()"
      >
        <mat-icon>{{ link.icon }}</mat-icon>
        <span>{{ link.label }}</span>
      </a>

      <button type="button" class="nav-link logout-link" (click)="logout()">
        <mat-icon>logout</mat-icon>
        <span>Salir</span>
      </button>
    </div>
  </div>
</nav>

<!-- üîπ Overlay mobile -->
<div class="navbar-overlay" *ngIf="menuOpen()" (click)="closeMenu()"></div>

<!-- üîπ Overlay para cerrar men√∫ de upload -->
<div class="upload-menu-overlay" *ngIf="uploadMenuOpen()" (click)="closeUploadMenu()"></div>

<!-- üîπ Modal de crear √°lbum -->
<app-album-creator
  *ngIf="showAlbumCreator()"
  (close)="closeAlbumCreator()"
  (create)="onCreateAlbum($event)"
></app-album-creator>
